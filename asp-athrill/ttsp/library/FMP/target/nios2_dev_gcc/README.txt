
	TTSP - TOPPERS Test Suite Package -
	ASPカーネル nios2_dev_gcc依存部 設定ガイド

----------------------------------------------------------------------
 TTSP
     TOPPERS Test Suite Package

 Copyright (C) 2010-2011 by Center for Embedded Computing Systems
             Graduate School of Information Science, Nagoya Univ., JAPAN
 Copyright (C) 2010-2011 by Digital Craft Inc.
 Copyright (C) 2010-2011 by NEC Communication Systems, Ltd.
 Copyright (C) 2010-2011 by FUJISOFT INCORPORATED
 Copyright (C) 2010-2011 by Industrial Technology Institute,
                                 Miyagi Prefectural Government, JAPAN

 上記著作権者は，以下の (1)〜(3) の条件を満たす場合に限り，本ドキュメ
 ント（本ドキュメントを改変したものを含む．以下同じ）を使用・複製・改
 変・再配布（以下，利用と呼ぶ）することを無償で許諾する．
 (1) 本ドキュメントを利用する場合には，上記の著作権表示，この利用条件
     および下記の無保証規定が，そのままの形でドキュメント中に含まれて
     いること．
 (2) 本ドキュメントを改変する場合には，ドキュメントを改変した旨の記述
     を，改変後のドキュメント中に含めること．ただし，改変後のドキュメ
     ントが，TOPPERSプロジェクト指定の開発成果物である場合には，この限
     りではない．
 (3) 本ドキュメントの利用により直接的または間接的に生じるいかなる損害
     からも，上記著作権者およびTOPPERSプロジェクトを免責すること．また，
     本ドキュメントのユーザまたはエンドユーザからのいかなる理由に基づ
     く請求からも，上記著作権者およびTOPPERSプロジェクトを免責すること．

 本ドキュメントは，無保証で提供されているものである．上記著作権者およ
 びTOPPERSプロジェクトは，本ドキュメントに関して，特定の使用目的に対す
 る適合性も含めて，いかなる保証も行わない．また，本ドキュメントの利用
 により直接的または間接的に生じたいかなる損害に関しても，その責任を負
 わない．

 $Id: README.txt 2 2012-05-09 02:23:52Z nces-shigihara $
----------------------------------------------------------------------
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
 動作確認した環境
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
 TOPPERS/FMPカーネル Release 1.2.0
 ターゲットボード
  ・Nios II 開発キット Stratix プロフェッショナルエディション
    (nios2_dev_1s40)
 Windows XP Pro sp3
 Cygwin 1.7.1(0.218/5/3)
  make 3.81
  perl 5.10.1
  ruby: 1.8.7
 QuartusII version 11sp1
  nios2-elf-gcc.exe (Altera 11.0sp1 Build 208) 4.1.2
  nios2-elf-gdb.exe (Altera 11.0sp1 Build 208) 7.0


ターゲット依存APIの割込み発生関数を用いたテストをサポートするために，ハ
ードウェアを追加する必要がある．Nios2依存部は，プロセッサ間割込みのハー
ドウェア（proc_int）を6つ追加した環境においてテストを実施した．ハードウ
ェアのアドレスと対応するプロセッサ番号および割込み番号は以下の通りである．

──────┬───────┬─────
アドレス    │プロセッサ番号│割込み番号
──────┼───────┼─────
0x07114000  │   1          │   7
0x07114010  │   1          │   8
0x07114020  │   1          │   9
0x07114030  │   2          │   7
0x07114040  │   2          │   8
0x07114050  │   2          │   9
──────┴───────┴─────

アドレスや割込み番号を変更する際には，ttsp_target_test.cを編集する．

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
 TTSPの設定手順
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
ttsp/configure.sh 48行目
修正後：TARGET_NAME="nios2_dev_gcc"

ttsp/configure.sh 54行目
修正後：PROFILE_NAME="FMP"


━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
 その他
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

ターゲットボードなどによって sil_dly_nse にかかる時間が変化すると予想さ
れる．それに伴い，configure.yamlの以下の値を変更しなければならない場合が
ある．
  ACTIVATE_ALARM_TIME : 1000
  WAIT_ALARM_TIME     : 1050

また，ターゲット依存APIの割込み発生関数では，割込み番号を1プロセッサにつ
き3つまでしか用意していないため，複数のテストケースを1つのテストプログラ
ムとしてマージできない場合がある．詳しくは，tools/ttg/user.txtの"(8.1) 
ターゲット依存マクロの定義に関して"を参照のこと．

オートコードテストプログラムの実行は10分割したものをベースに，上の理由で
マージできなかったためさらに分割し，最終的に12分割したもので行った．これ
より少ない数に分割して実行する際にはスタックサイズが不足し，テストが通ら
なくなる可能性がある．

以上．
